<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>AI Card – Generate Photo</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #322D47 0, #1E223E 100%);
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    .container {
      width: 98vw;
      max-width: 410px;
      background: rgba(23,18,38,0.83);
      border-radius: 22px;
      box-shadow: 0 6px 22px #00000045;
      margin: 38px auto 18px;
      padding: 28px 16px 24px;
    }
    .card-title {
      text-align:center;
      font-size: 1.33rem;
      font-weight: 700;
      color: #fde2ff;
      margin-bottom: 5px;
      letter-spacing:1px;
    }
    .prompt-text {
      color: #a7e1ed;
      font-size:1.04rem;
      margin-bottom: 20px;
      text-align:center;
      font-weight:400;
      word-break: break-word;
    }
    .upload-section {
      margin-bottom: 22px;
      text-align:center;
    }
    .file-label {
      background: linear-gradient(90deg,#41cf60 0,#20e6d2 100%);
      color: #fff;
      padding: 9px 24px;
      border-radius: 20px;
      font-weight:500;
      cursor:pointer;
      display:inline-block;
      margin-bottom:10px;
      font-size: 1.05rem;
      box-shadow:0 2px 8px #25ffcc22;
      border:none;
    }
    #fileInput { display: none; }
    #previewImg {
      display:block;
      margin:10px auto 16px;
      width:96%;
      max-width:340px;
      aspect-ratio:16/9;
      height:auto;
      object-fit:cover;
      border-radius:15px;
      box-shadow:0 2px 12px #00000018;
      background:#fff;
    }
    .generate-btn {
      background: linear-gradient(90deg,#5e5fff 0,#41cf60 100%);
      color:#fff;
      font-weight:700;
      border:none;
      border-radius:24px;
      padding:13px 30px;
      font-size:1.09rem;
      margin:18px auto 14px;
      display:block;
      cursor:pointer;
      box-shadow:0 3px 18px #2500ff18;
      transition: all 0.18s;
      letter-spacing:0.5px;
    }
    .generate-btn:hover { transform:translateY(-2px); opacity:0.92;}
    .copied-text {
      color:#94f5b7;
      font-size:0.99rem;
      text-align:center;
      margin-top:9px;
    }
    @media (max-width: 480px) {
      .container { padding:14px 4vw 16px; }
      #previewImg { max-width:97vw; }
      .card-title {font-size:1.15rem;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card-title" id="cardTitle"></div>
    <div class="prompt-text" id="cardPrompt"></div>
    <div class="upload-section">
      <label for="fileInput" class="file-label">अपनी फोटो चुनें</label>
      <input type="file" id="fileInput" accept="image/*">
      <img id="previewImg" style="display:none;" />
    </div>
    <button class="generate-btn" id="genBtn">AI Generate Now</button>
    <div class="copied-text" id="copiedText"></div>
  </div>
  <script>
    const backendBase = 'https://aiimage-q8fv.onrender.com';
    // Get card id from URL (card.html?id=xyz)
    const urlParams = new URLSearchParams(window.location.search);
    const cardId = urlParams.get('id');
    async function fetchCard() {
      try {
        const res = await fetch(backendBase + '/api/cards');
        const allCards = await res.json();
        return allCards[cardId] || allCards[0];
      } catch(err) { return null; }
    }
    async function init() {
      const card = await fetchCard();
      if (!card) return;
      document.getElementById('cardTitle').textContent = card.buttonName || 'AI Card';
      document.getElementById('cardPrompt').textContent = card.promptText || '';
      document.getElementById('copiedText').textContent = '';
      // File upload/preview logic
      const fileInput = document.getElementById('fileInput');
      const previewImg = document.getElementById('previewImg');
      fileInput.onchange = function(e) {
        const file = e.target.files[0];
        if(file){
          const reader = new FileReader();
          reader.onload = function(ev) {
            previewImg.src = ev.target.result;
            previewImg.style.display = "block";
          };
          reader.readAsDataURL(file);
        } else {
          previewImg.style.display = "none";
        }
      };
      document.getElementById('genBtn').onclick = function() {
        navigator.clipboard.writeText(card.promptText).then(()=>{
          document.getElementById('copiedText').textContent =
            'Prompt copied! अब Microsoft Copilot पर जाइये, फोटो upload करें और prompt paste करें.';
        });
        window.open('https://copilot.microsoft.com/', '_blank');
      };
    }
    init();
  </script>
</body>
</html>
