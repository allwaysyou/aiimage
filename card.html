<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>AI Card – Generate Photo</title>
  <style>
    body { background: linear-gradient(135deg, #322D47 0, #1E223E 100%);
      font-family: 'Segoe UI', Arial, sans-serif; margin: 0; }
    .container {
      width: 100%; max-width: 460px; margin: 38px auto;
      background: rgba(20,24,46,0.7); border-radius: 25px;
      box-shadow: 0 8px 32px #00000055; padding: 24px 22px; }
    .card-title {
      font-size: 1.5rem; font-weight: 700; color: #fde2ff; margin-bottom: 10px; text-align:center;
      letter-spacing:1px;
    }
    .prompt-text {
      color: #a7e1ed; font-size:1.05rem; margin-bottom: 18px; text-align:center; font-weight:400;
    }
    .upload-section { margin-bottom: 18px; text-align:center; }
    .file-label {
      background: linear-gradient(90deg,#41cf60 0,#20e6d2 100%);
      color: #fff; padding: 7px 22px;
      border-radius: 22px; font-weight:500; cursor:pointer;
      display:inline-block; margin-bottom:8px; box-shadow:0 2px 8px #25ffcc22;
    }
    #fileInput { display:none; }
    #previewImg {
      display:block; margin:10px auto 12px; width:100%; max-width:320px;
      aspect-ratio:16/9; height:auto; object-fit:cover;
      border-radius:18px; box-shadow:0 2px 16px #00000018;
      background:#fff;
    }
    .generate-btn {
      background: linear-gradient(90deg,#5e5fff 0,#41cf60 100%);
      color:#fff;font-weight:700; border:none;
      border-radius:24px; padding:12px 32px; font-size:1.08rem;
      margin:16px auto 0; display:block; cursor:pointer;
      box-shadow:0 3px 16px #2500ff22;
      letter-spacing:0.5px; transition: all 0.18s;
    }
    .generate-btn:hover { transform:translateY(-2px); opacity:0.92;}
    .copied-text { color:#94f5b7;font-size:0.97rem;text-align:center;margin-top:14px;}
  </style>
</head>
<body>
  <div class="container">
    <div class="card-title" id="cardTitle"></div>
    <div class="prompt-text" id="cardPrompt"></div>
    <div class="upload-section">
      <label for="fileInput" class="file-label">अपनी फोटो चुनें</label>
      <input type="file" id="fileInput" accept="image/*">
      <img id="previewImg" style="display:none;" />
    </div>
    <button class="generate-btn" id="genBtn">AI Generate Now</button>
    <div class="copied-text" id="copiedText"></div>
  </div>
  <script>
    const backendBase = 'https://aiimage-q8fv.onrender.com';

    // Get card id from URL (card.html?id=xyz)
    const urlParams = new URLSearchParams(window.location.search);
    const cardId = urlParams.get('id');

    // Fetch single card data from backend
    async function fetchCard() {
      try {
        const res = await fetch(backendBase + '/api/cards');
        const allCards = await res.json();
        // Select by index or id, change logic as per backend
        return allCards[cardId] || allCards[0];
      } catch(err) { return null; }
    }

    async function init() {
      const card = await fetchCard();
      if (!card) return;

      document.getElementById('cardTitle').textContent = card.buttonName || 'AI Studio';
      document.getElementById('cardPrompt').textContent = card.promptText || '';
      document.getElementById('copiedText').textContent = '';

      // File upload logic + preview
      const fileInput = document.getElementById('fileInput');
      const previewImg = document.getElementById('previewImg');

      fileInput.onchange = function(e) {
        const file = e.target.files[0];
        if(file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            previewImg.src = event.target.result;
            previewImg.style.display = "block";
          };
          reader.readAsDataURL(file);
        } else {
          previewImg.style.display = "none";
        }
      };

      // Button — On Click: Copy prompt, Open Copilot Web in new tab
      document.getElementById('genBtn').onclick = function() {
        navigator.clipboard.writeText(card.promptText).then(()=>{
          document.getElementById('copiedText').textContent = 'Prompt copied! अब अपनी फोटो, Copilot के image creator में paste karein.';
        });
        // Open Microsoft Copilot AI web in new tab
        window.open('https://copilot.microsoft.com/', '_blank');
      };
    }
    init();
  </script>
</body>
</html>
